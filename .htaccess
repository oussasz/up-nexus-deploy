RewriteEngine On

# Force HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Handle API requests - proxy to Node.js
RewriteCond %{REQUEST_URI} ^/api
RewriteRule ^(.*)$ http://127.0.0.1:3000/$1 [P,L]

# Redirect legacy /pages/*.html URLs to clean routes (301 redirect)
RewriteCond %{THE_REQUEST} \s/+pages/([^\s?]+)\.html [NC]
RewriteRule ^ /%1 [L,R=301,NE]

# Clean URL rewrites - internally serve the actual HTML files
RewriteRule ^ecosystem$ /pages/ecosystem.html [L]
RewriteRule ^contact$ /pages/contact.html [L]
RewriteRule ^about$ /pages/about.html [L]
RewriteRule ^announcements$ /pages/announcements.html [L]
RewriteRule ^pricing$ /pages/pricing.html [L]
RewriteRule ^auth/login$ /pages/auth/login.html [L]
RewriteRule ^auth/register$ /pages/auth/register.html [L]
RewriteRule ^auth/forgot$ /pages/auth/forgot.html [L]
RewriteRule ^admin/login$ /pages/admin/login.html [L]
RewriteRule ^admin/dashboard$ /pages/admin/dashboard.html [L]
RewriteRule ^dashboard$ /pages/dashboard/index.html [L]
RewriteRule ^dashboard/pending$ /pages/dashboard/pending.html [L]
